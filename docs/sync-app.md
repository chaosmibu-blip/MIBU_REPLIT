# ğŸ“± App åŒæ­¥æŒ‡ä»¤

> æ­¤æª”æ¡ˆç”±å¾Œç«¯è‡ªå‹•æ›´æ–°ï¼Œå‰ç«¯ Claude Code è®€å–å¾ŒåŸ·è¡Œ

---

## æœ€æ–°æ›´æ–°

### 2026-01-17 #005ï¼šğŸš¨ UI ç•«é¢å¯¦ä½œï¼ˆå¯©è¨ˆç™¼ç¾ç¼ºå¤±ï¼‰

**è®Šæ›´é¡å‹**: ğŸ”´ é‡å¤§ç¼ºå¤±ï¼ˆUI ç•«é¢æœªå¯¦ä½œï¼‰

**èƒŒæ™¯èªªæ˜**:
ç¶“ä¸‰ç«¯å¯©è¨ˆç™¼ç¾ï¼ŒAPP å·²å®Œæˆ Types + Services å±¤ï¼Œä½†**ç¼ºå°‘å°æ‡‰çš„ UI ç•«é¢**ã€‚
- âœ… `src/types/` - 4 å€‹é¡å‹æª”æ¡ˆå·²å»ºç«‹
- âœ… `src/services/` - 4 å€‹ API æœå‹™å·²å»ºç«‹
- âŒ `src/screens/` æˆ– `app/` - ç„¡å°æ‡‰ç•«é¢

**å¯©è¨ˆä¾†æº**: å¾Œç«¯ SYNC_QUEUE.md #005

---

#### APP éœ€è¦åšçš„äº‹

##### 1. ç¶“æ¿Ÿç³»çµ±ç•«é¢ï¼ˆPhase 1ï¼‰

**æ–°å¢æª”æ¡ˆ**:
- `src/screens/EconomyScreen.tsx` æˆ– `app/(tabs)/economy.tsx`

**åŠŸèƒ½éœ€æ±‚**:

| å…ƒç´  | API | èªªæ˜ |
|------|-----|------|
| ç­‰ç´šå¡ç‰‡ | `GET /api/user/level` | é¡¯ç¤ºç­‰ç´šã€ç¶“é©—å€¼é€²åº¦æ¢ |
| ç¶“é©—å€¼æ­·å² | `GET /api/user/experience/history` | æ­·å²è¨˜éŒ„åˆ—è¡¨ |
| æˆå°±å¾½ç« ç‰† | `GET /api/user/achievements` | æˆå°±å¡ç‰‡ç¶²æ ¼ |
| é ˜å–æŒ‰éˆ• | `POST /api/user/achievements/:id/claim` | æœªé ˜å–æˆå°±çš„ã€Œé ˜å–ã€æŒ‰éˆ• |

**UI åƒè€ƒ**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Lv.15 æ—…è¡Œé”äºº              â”‚
â”‚  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘ 2,450/3,000 XP  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ† æˆå°± (12/30)            â”‚
â”‚  â”Œâ”€â”€â”€â” â”Œâ”€â”€â”€â” â”Œâ”€â”€â”€â” â”Œâ”€â”€â”€â”  â”‚
â”‚  â”‚ ğŸ¯ â”‚ â”‚ ğŸ—ºï¸ â”‚ â”‚ ğŸ“¸ â”‚ â”‚ ğŸ”’ â”‚  â”‚
â”‚  â””â”€â”€â”€â”˜ â””â”€â”€â”€â”˜ â””â”€â”€â”€â”˜ â””â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

##### 2. å‹Ÿè³‡ç³»çµ±ç•«é¢ï¼ˆPhase 2ï¼‰

**æ–°å¢æª”æ¡ˆ**:
- `src/screens/CrowdfundScreen.tsx` æˆ– `app/crowdfund/index.tsx`
- `src/screens/CrowdfundDetailScreen.tsx` æˆ– `app/crowdfund/[id].tsx`

**åŠŸèƒ½éœ€æ±‚**:

| å…ƒç´  | API | èªªæ˜ |
|------|-----|------|
| æ´»å‹•åˆ—è¡¨ | `GET /api/crowdfund/campaigns` | é€²è¡Œä¸­/å³å°‡é–‹å§‹æ´»å‹• |
| æ´»å‹•è©³æƒ… | `GET /api/crowdfund/campaigns/:id` | é€²åº¦ã€è´ŠåŠ©è€…åˆ—è¡¨ |
| IAP è´ŠåŠ© | `POST /api/crowdfund/contribute` | iOS/Android IAP ä¸²æ¥ |
| æˆ‘çš„è´ŠåŠ© | `GET /api/crowdfund/my-contributions` | å€‹äººè´ŠåŠ©è¨˜éŒ„ |

##### 3. æ¨è–¦ç³»çµ±ç•«é¢ï¼ˆPhase 3ï¼‰

**æ–°å¢æª”æ¡ˆ**:
- `src/screens/ReferralScreen.tsx` æˆ– `app/referral/index.tsx`

**åŠŸèƒ½éœ€æ±‚**:

| å…ƒç´  | API | èªªæ˜ |
|------|-----|------|
| æˆ‘çš„æ¨è–¦ç¢¼ | `GET /api/referral/my-code` | æ¨è–¦ç¢¼ + è¤‡è£½/åˆ†äº«æŒ‰éˆ• |
| è¼¸å…¥æ¨è–¦ç¢¼ | `POST /api/referral/apply` | è¼¸å…¥æ¡† + å¥—ç”¨æŒ‰éˆ• |
| æ¨è–¦æ¸…å–® | `GET /api/referral/my-referrals` | æˆ‘æ¨è–¦çš„äººåˆ—è¡¨ |
| çå‹µé¤˜é¡ | `GET /api/referral/balance` | é¤˜é¡é¡¯ç¤º |
| ç”³è«‹æç¾ | `POST /api/referral/withdraw` | æç¾è¡¨å–® |

##### 4. ç”¨æˆ¶è²¢ç»ç•«é¢ï¼ˆPhase 4ï¼‰

**æ–°å¢æª”æ¡ˆ**:
- `src/screens/ContributionScreen.tsx` æˆ– `app/contribution/index.tsx`

**åŠŸèƒ½éœ€æ±‚**:

| å…ƒç´  | API | èªªæ˜ |
|------|-----|------|
| å›å ±æ­‡æ¥­ | `POST /api/contribution/report-closed` | æ™¯é»è©³æƒ…é æŒ‰éˆ• |
| å»ºè­°æ™¯é» | `POST /api/contribution/suggest-place` | æ–°æ™¯é»è¡¨å–® |
| ç¤¾ç¾¤æŠ•ç¥¨ | `GET /api/contribution/pending-votes` | å¾…æŠ•ç¥¨åˆ—è¡¨ |
| æŠ•ç¥¨æŒ‰éˆ• | `POST /api/contribution/vote/:placeId` | è´Šæˆ/åå° |

##### 5. å¸³è™Ÿç¶å®šç•«é¢ï¼ˆPhase 5ï¼‰

**æ–°å¢æª”æ¡ˆ**:
- `src/screens/AccountScreen.tsx` æˆ– `app/account/index.tsx`

**åŠŸèƒ½éœ€æ±‚**:

| å…ƒç´  | API | èªªæ˜ |
|------|-----|------|
| å·²ç¶å®šå¸³è™Ÿ | `GET /api/auth/linked-accounts` | Apple/Google/Line åˆ—è¡¨ |
| ç¶å®šæ–°å¸³è™Ÿ | `POST /api/auth/link` | å„å¹³å° OAuth æŒ‰éˆ• |
| è§£é™¤ç¶å®š | `DELETE /api/auth/unlink/:provider` | å„å¸³è™Ÿæ—çš„è§£é™¤æŒ‰éˆ• |

---

#### å°èˆªæ•´åˆå»ºè­°

```
app/
â”œâ”€â”€ (tabs)/
â”‚   â”œâ”€â”€ index.tsx         # é¦–é 
â”‚   â”œâ”€â”€ gacha/            # æ‰­è›‹ï¼ˆå·²æœ‰ï¼‰
â”‚   â”œâ”€â”€ collection.tsx    # æ”¶è—ï¼ˆå·²æœ‰ï¼‰
â”‚   â”œâ”€â”€ planner/          # ç­–ç•«ï¼ˆå·²æœ‰ï¼‰
â”‚   â”œâ”€â”€ settings.tsx      # è¨­å®šï¼ˆå·²æœ‰ï¼‰
â”‚   â””â”€â”€ profile/          # ğŸ‘ˆ å»ºè­°æ–°å¢
â”‚       â”œâ”€â”€ index.tsx     # å€‹äººè³‡æ–™é¦–é 
â”‚       â”œâ”€â”€ economy.tsx   # ç¶“æ¿Ÿç³»çµ±ï¼ˆç­‰ç´š/æˆå°±ï¼‰
â”‚       â”œâ”€â”€ referral.tsx  # æ¨è–¦ç³»çµ±
â”‚       â””â”€â”€ account.tsx   # å¸³è™Ÿç¶å®š
â”œâ”€â”€ crowdfund/            # ğŸ‘ˆ å»ºè­°æ–°å¢
â”‚   â”œâ”€â”€ index.tsx         # å‹Ÿè³‡åˆ—è¡¨
â”‚   â””â”€â”€ [id].tsx          # å‹Ÿè³‡è©³æƒ…
â””â”€â”€ contribution/         # ğŸ‘ˆ å»ºè­°æ–°å¢
    â””â”€â”€ index.tsx         # ç¤¾ç¾¤è²¢ç»
```

---

#### å¯¦ä½œå„ªå…ˆé †åº

1. **é«˜å„ªå…ˆç´š**ï¼šç¶“æ¿Ÿç³»çµ±ï¼ˆç”¨æˆ¶ç•™å­˜æ ¸å¿ƒï¼‰ã€å¸³è™Ÿç¶å®šï¼ˆå®‰å…¨æ€§ï¼‰
2. **ä¸­å„ªå…ˆç´š**ï¼šæ¨è–¦ç³»çµ±ï¼ˆæˆé•·å¼•æ“ï¼‰
3. **ä½å„ªå…ˆç´š**ï¼šå‹Ÿè³‡ç³»çµ±ã€ç”¨æˆ¶è²¢ç»ï¼ˆå¯å¾ŒçºŒè¿­ä»£ï¼‰

---

#### é©—è­‰æ–¹å¼

1. å„ç•«é¢æ­£ç¢ºå‘¼å«å°æ‡‰ API
2. UI æ­£å¸¸é¡¯ç¤ºè³‡æ–™
3. éŒ¯èª¤è™•ç†ç¬¦åˆ `contracts/COMMON.md` è¦ç¯„
4. å°èˆªå¯æ­£å¸¸é€²å…¥å„ç•«é¢

---

#### å®Œæˆå¾Œ

1. Commit + Push
2. åœ¨ `docs/sync-backend.md` è¨˜éŒ„å®Œæˆç‹€æ…‹ï¼ˆ#005ï¼‰
3. å†æ¬¡ Commit + Push

---

### 2026-01-17 #003ï¼šğŸš€ Phase 1-6 API å¯¦ä½œå®Œæˆ

**è®Šæ›´é¡å‹**: ğŸ”´ é‡å¤§æ›´æ–°ï¼ˆå¤šå€‹æ–° APIï¼‰

**èƒŒæ™¯èªªæ˜**:
å¾Œç«¯å·²å®Œæˆ Phase 1-6 å…¨éƒ¨ API å¯¦ä½œï¼Œå¥‘ç´„å·²æ›´æ–°è‡³ v1.2.0ã€‚APP éœ€è¦å¯¦ä½œå°æ‡‰åŠŸèƒ½é é¢ã€‚

**API å¥‘ç´„ç‰ˆæœ¬**: `contracts/APP.md` v1.2.0

---

#### APP éœ€è¦åšçš„äº‹

##### Phase 1 ç¶“æ¿Ÿç³»çµ±ï¼ˆ4 å€‹ APIï¼‰

| API | åŠŸèƒ½ | UI å»ºè­° |
|-----|------|---------|
| `GET /api/user/level` | ç­‰ç´šè³‡è¨Š | å€‹äººé é¢é¡¯ç¤ºç­‰ç´šã€ç¶“é©—å€¼é€²åº¦æ¢ |
| `GET /api/user/experience/history` | ç¶“é©—å€¼è¨˜éŒ„ | ç¶“é©—å€¼æ­·å²åˆ—è¡¨é  |
| `GET /api/user/achievements` | æˆå°±åˆ—è¡¨ | æˆå°±å¾½ç« ç‰† |
| `POST /api/user/achievements/:id/claim` | é ˜å–æˆå°±çå‹µ | æˆå°±å¡ç‰‡ã€Œé ˜å–ã€æŒ‰éˆ• |

##### Phase 2 å‹Ÿè³‡ç³»çµ±ï¼ˆ4 å€‹ APIï¼‰

| API | åŠŸèƒ½ | UI å»ºè­° |
|-----|------|---------|
| `GET /api/crowdfund/campaigns` | å‹Ÿè³‡æ´»å‹•åˆ—è¡¨ | å‹Ÿè³‡é¦–é  |
| `GET /api/crowdfund/campaigns/:id` | æ´»å‹•è©³æƒ… | æ´»å‹•è©³æƒ…é  |
| `POST /api/crowdfund/contribute` | IAP è´ŠåŠ© | è´ŠåŠ©æŒ‰éˆ•ï¼ˆä¸²æ¥ iOS/Android IAPï¼‰ |
| `GET /api/crowdfund/my-contributions` | æˆ‘çš„è´ŠåŠ©è¨˜éŒ„ | å€‹äººé é¢ã€Œæˆ‘çš„è´ŠåŠ©ã€ |

##### Phase 3 æ¨è–¦ç³»çµ±ï¼ˆ6 å€‹ APIï¼‰

| API | åŠŸèƒ½ | UI å»ºè­° |
|-----|------|---------|
| `GET /api/referral/my-code` | æˆ‘çš„æ¨è–¦ç¢¼ | åˆ†äº«é é¢é¡¯ç¤ºæ¨è–¦ç¢¼ + è¤‡è£½/åˆ†äº«æŒ‰éˆ• |
| `POST /api/referral/apply` | ä½¿ç”¨æ¨è–¦ç¢¼ | è¨»å†Šæµç¨‹æˆ–è¨­å®šé è¼¸å…¥æ¨è–¦ç¢¼ |
| `GET /api/referral/my-referrals` | æ¨è–¦æ¸…å–® | æˆ‘çš„æ¨è–¦äººåˆ—è¡¨ |
| `POST /api/referral/merchant` | æ¨è–¦å•†å®¶ | å•†å®¶æ¨è–¦åŠŸèƒ½ï¼ˆé€²éšï¼‰ |
| `GET /api/referral/balance` | é¤˜é¡æŸ¥è©¢ | æ¨è–¦çå‹µé¤˜é¡é¡¯ç¤º |
| `POST /api/referral/withdraw` | ç”³è«‹æç¾ | æç¾ç”³è«‹è¡¨å–® |

##### Phase 4 ç”¨æˆ¶è²¢ç»ç³»çµ±ï¼ˆ5 å€‹ APIï¼‰

| API | åŠŸèƒ½ | UI å»ºè­° |
|-----|------|---------|
| `POST /api/contribution/report-closed` | å›å ±æ­‡æ¥­ | æ™¯é»è©³æƒ…é ã€Œå›å ±å•é¡Œã€æŒ‰éˆ• |
| `POST /api/contribution/suggest-place` | å»ºè­°æ™¯é» | ã€Œå»ºè­°æ–°æ™¯é»ã€è¡¨å–® |
| `POST /api/collection/:placeId/blacklist` | åŠ å…¥é»‘åå–® | æ™¯é»å¡ç‰‡ã€Œä¸æƒ³å†çœ‹åˆ°ã€é¸é … |
| `GET /api/contribution/pending-votes` | å¾…æŠ•ç¥¨åˆ—è¡¨ | ç¤¾ç¾¤æŠ•ç¥¨é é¢ |
| `POST /api/contribution/vote/:placeId` | æŠ•ç¥¨ | æŠ•ç¥¨æŒ‰éˆ•ï¼ˆè´Šæˆ/åå°ï¼‰ |

##### Phase 5 å¸³è™Ÿç³»çµ±ï¼ˆ4 å€‹ APIï¼‰

| API | åŠŸèƒ½ | UI å»ºè­° |
|-----|------|---------|
| `POST /api/auth/link` | ç¶å®šæ–°èº«ä»½ | è¨­å®šé ã€Œé€£çµå¸³è™Ÿã€ |
| `GET /api/auth/linked-accounts` | å·²ç¶å®šå¸³è™Ÿ | é¡¯ç¤ºå·²ç¶å®šçš„ Apple/Google/Line |
| `DELETE /api/auth/unlink/:provider` | è§£é™¤ç¶å®š | å„å¸³è™Ÿæ—ã€Œè§£é™¤ç¶å®šã€æŒ‰éˆ• |
| `POST /api/specialist/apply` | ç”³è«‹ç­–åŠƒå¸« | ã€Œæˆç‚ºç­–åŠƒå¸«ã€ç”³è«‹è¡¨å–® |

---

#### å¯¦ä½œå„ªå…ˆé †åºå»ºè­°

1. **é«˜å„ªå…ˆç´š**ï¼šPhase 1 ç¶“æ¿Ÿç³»çµ±ï¼ˆç”¨æˆ¶ç•™å­˜æ ¸å¿ƒï¼‰
2. **ä¸­å„ªå…ˆç´š**ï¼šPhase 3 æ¨è–¦ç³»çµ±ã€Phase 5 å¸³è™Ÿç¶å®š
3. **ä½å„ªå…ˆç´š**ï¼šPhase 2 å‹Ÿè³‡ã€Phase 4 ç”¨æˆ¶è²¢ç»ï¼ˆå¯å¾ŒçºŒè¿­ä»£ï¼‰

---

#### é©—è­‰æ–¹å¼

1. å„ API ç«¯é»å‘¼å«æ­£å¸¸ï¼ˆåƒè€ƒ `contracts/APP.md` çš„ Request/Response schemaï¼‰
2. UI é é¢æ­£å¸¸é¡¯ç¤ºè³‡æ–™
3. éŒ¯èª¤è™•ç†ç¬¦åˆ `contracts/COMMON.md` è¦ç¯„

---

#### å®Œæˆå¾Œ

1. Commit + Push
2. åœ¨ `docs/sync-backend.md` è¨˜éŒ„å®Œæˆç‹€æ…‹ï¼ˆ#003ï¼‰
3. å†æ¬¡ Commit + Push

---

### 2026-01-17 #004ï¼šğŸ“ å¾Œç«¯ CLAUDE.md v2.0 æ›´æ–°

**è®Šæ›´é¡å‹**: ğŸŸ¡ æ–‡ä»¶æ›´æ–°ï¼ˆä½å„ªå…ˆç´šï¼‰

**èƒŒæ™¯èªªæ˜**:
å¾Œç«¯ CLAUDE.md æ›´æ–°è‡³ v2.0ï¼Œè³‡æ–™è¡¨æ•¸é‡ã€è¨˜æ†¶åº«æ•¸é‡æœ‰è®Šæ›´ã€‚

**è®Šæ›´å…§å®¹**:
- è³‡æ–™è¡¨æ•¸é‡ï¼š57 â†’ 82 å¼µè¡¨/åˆ—èˆ‰
- è¨˜æ†¶åº«æ•¸é‡ï¼š15 â†’ 22 å€‹
- æ–°å¢ Phase 1-6 é–‹ç™¼éšæ®µè¨˜éŒ„
- æ›´æ–°è·¯ç”±ã€Storage æ¨¡çµ„æ¸…å–®

---

#### APP éœ€è¦åšçš„äº‹

##### æª¢æŸ¥ CLAUDE.md å¼•ç”¨

å¦‚æœ APP çš„ CLAUDE.md æœ‰å¼•ç”¨å¾Œç«¯è³‡æ–™ï¼š

```markdown
# æª¢æŸ¥ä¸¦æ›´æ–°ä»¥ä¸‹æ•¸æ“šï¼ˆå¦‚æœ‰å¼•ç”¨ï¼‰ï¼š
- å¾Œç«¯è³‡æ–™è¡¨æ•¸é‡ï¼š82 å¼µè¡¨/åˆ—èˆ‰
- å¾Œç«¯è¨˜æ†¶åº«æ•¸é‡ï¼š22 å€‹
- API å¥‘ç´„ç‰ˆæœ¬ï¼šv1.2.0
```

##### ç¢ºèªå¥‘ç´„åƒç…§è·¯å¾‘

```markdown
# ç¢ºèªä»¥ä¸‹è·¯å¾‘æ­£ç¢ºï¼š
- memory-data-schema.mdï¼ˆç¾ç‚º 82 å¼µè¡¨ï¼‰
- memory-api-dictionary.md
- memory-auth.md
- contracts/APP.mdï¼ˆv1.2.0ï¼‰
```

---

#### å®Œæˆå¾Œ

1. å¦‚æœ‰æ›´æ–°ï¼šCommit + Push
2. åœ¨ `docs/sync-backend.md` è¨˜éŒ„å®Œæˆç‹€æ…‹ï¼ˆ#004ï¼‰

---

### 2026-01-16 #002ï¼šğŸ§¹ æ–‡ä»¶æ¸…ç† - æ­¸æª”èˆŠæ–‡ä»¶

**è®Šæ›´é¡å‹**: ğŸŸ¡ æ–‡ä»¶æ•´ç†ï¼ˆé API è®Šæ›´ï¼‰

**èƒŒæ™¯èªªæ˜**:
å¾Œç«¯å·²å®Œæˆæ–‡ä»¶æ¸…ç†ï¼Œå°‡èˆŠè¦åŠƒæ–‡ä»¶ç§»åˆ° `archive/`ï¼Œä¸¦æ‹†åˆ†éå¤§çš„è¨˜æ†¶åº«ã€‚APP ä¹Ÿéœ€è¦æª¢æŸ¥ä¸¦æ¸…ç†ä¸å¿…è¦çš„æ–‡ä»¶ã€‚

---

#### APP éœ€è¦åšçš„äº‹

##### 1. æª¢æŸ¥ docs/ ç›®éŒ„

æƒæä»¥ä¸‹é¡å‹çš„æ–‡ä»¶ï¼Œè©•ä¼°æ˜¯å¦éœ€è¦æ­¸æª”ï¼š

| é¡å‹ | åˆ¤æ–·æ¨™æº– | å‹•ä½œ |
|------|----------|------|
| ä¸€æ¬¡æ€§å ±å‘Šï¼ˆaudit, reportï¼‰ | å·²éæ™‚ | ç§»åˆ° `docs/archive/` |
| èˆŠè¦åŠƒæ–‡ä»¶ï¼ˆplan, blueprintï¼‰ | å·²å¯¦ä½œå®Œæˆ | ç§»åˆ° `docs/archive/` |
| èˆ‡å¾Œç«¯é‡è¤‡çš„æ–‡ä»¶ | å¾Œç«¯æœ‰æ›´æ–°ç‰ˆæœ¬ | åˆªé™¤æˆ–æ­¸æª” |
| éå¤§çš„è¨˜æ†¶åº«ï¼ˆ>30KBï¼‰ | é›£ä»¥ç¶­è­· | è€ƒæ…®æ‹†åˆ† |

##### 2. å»ºç«‹ `docs/archive/` ç›®éŒ„ï¼ˆå¦‚æœæœ‰éœ€è¦æ­¸æª”çš„æ–‡ä»¶ï¼‰

##### 3. æª¢æŸ¥è¨˜æ†¶åº«å¤§å°

```bash
ls -lh docs/memory-*.md
```

å¦‚æœæœ‰è¶…é 30KB çš„è¨˜æ†¶åº«ï¼Œè€ƒæ…®æ‹†åˆ†ã€‚

##### 4. æ›´æ–° CLAUDE.mdï¼ˆå¦‚æœæœ‰æ–‡ä»¶è®Šå‹•ï¼‰

ç¢ºä¿ã€Œå¼·åˆ¶æŸ¥é–±è¦å‰‡ã€æŒ‡å‘æ­£ç¢ºçš„è¨˜æ†¶åº«ã€‚

---

#### é©—è­‰æ–¹å¼

1. æ²’æœ‰éæ™‚çš„ä¸€æ¬¡æ€§å ±å‘Šç•™åœ¨ `docs/` æ ¹ç›®éŒ„
2. è¨˜æ†¶åº«å¤§å°éƒ½åœ¨åˆç†ç¯„åœï¼ˆ<30KBï¼‰
3. CLAUDE.md çš„å¼·åˆ¶æŸ¥é–±è¦å‰‡æŒ‡å‘æ­£ç¢ºæ–‡ä»¶

---

#### å®Œæˆå¾Œ

1. Commit + Push
2. åœ¨ `docs/sync-backend.md` è¨˜éŒ„å®Œæˆç‹€æ…‹ï¼ˆ#002ï¼‰
3. å†æ¬¡ Commit + Push

---

### 2026-01-16 #001ï¼šğŸ”§ æ¶æ§‹å‡ç´š - ä¸‰ç«¯å”ä½œè¦ç¯„

**è®Šæ›´é¡å‹**: ğŸ”´ æ¶æ§‹å‡ç´šï¼ˆé API è®Šæ›´ï¼‰

**èƒŒæ™¯èªªæ˜**:
å¾Œç«¯å·²å»ºç«‹ã€Œä¸‰ç«¯å”ä½œè¦ç¯„ã€ï¼Œå®šç¾©å¾Œç«¯/APP/å®˜ç¶²çš„å”ä½œæ¡†æ¶ã€‚APP éœ€è¦é…åˆå»ºç«‹å°æ‡‰æ–‡ä»¶ã€‚

**å”ä½œè¦ç¯„æ–‡ä»¶ä½ç½®**:
- å¾Œç«¯ï¼š`docs/COLLABORATION.md`
- GitHubï¼šhttps://github.com/chaosmibu-blip/MIBU_REPLIT/blob/main/docs/COLLABORATION.md

---

#### APP éœ€è¦åšçš„äº‹

##### 1. å»ºç«‹ `docs/sync-backend.md`

ç”¨é€”ï¼šå›å ±å¾Œç«¯åŒæ­¥æŒ‡ä»¤çš„å®Œæˆç‹€æ…‹

```markdown
# ğŸ”„ å¾Œç«¯åŒæ­¥å›å ±

> APP å®Œæˆå¾Œç«¯åŒæ­¥æŒ‡ä»¤å¾Œï¼Œåœ¨æ­¤è¨˜éŒ„ç‹€æ…‹

---

## æœ€æ–°å›å ±

### 2026-01-16 #001

| é …ç›® | å…§å®¹ |
|------|------|
| ä¾†æº | å¾Œç«¯ sync-app.md #001 |
| æ”¶åˆ°æ™‚é–“ | YYYY-MM-DD HH:MM |
| å®Œæˆæ™‚é–“ | YYYY-MM-DD HH:MM |
| ç‹€æ…‹ | âœ… å®Œæˆ / ğŸ”„ é€²è¡Œä¸­ / âŒ æœ‰å•é¡Œ |

### å®Œæˆé …ç›®
- [ ] å»ºç«‹ docs/sync-backend.md
- [ ] æ›´æ–° CLAUDE.md åŠ å…¥ã€Œä¸‰ç«¯å”ä½œã€æ®µè½

### ç•°å¸¸å›å ±
ï¼ˆå¦‚æœæœ‰å•é¡Œï¼Œå¯«åœ¨é€™è£¡è®“å¾Œç«¯ AI çŸ¥é“ï¼‰

---

## æ­·å²å›å ±

ï¼ˆèˆŠçš„å›å ±å¾€ä¸‹ç§»å‹•ï¼‰
```

##### 2. æ›´æ–° CLAUDE.md

åœ¨ CLAUDE.md é–‹é ­çš„ã€Œå°ˆæ¡ˆå®šä½ã€æ®µè½ä¹‹å¾Œï¼ŒåŠ å…¥ä»¥ä¸‹å…§å®¹ï¼š

```markdown
## ä¸‰ç«¯å”ä½œ

> - å¾Œç«¯ GitHub: https://github.com/chaosmibu-blip/MIBU_REPLIT
> - APP GitHub: https://github.com/chaosmibu-blip/Mibu-Replit-APP-
> - å®˜ç¶² GitHub: https://github.com/chaosmibu-blip/Mibu-Pages
> - å”ä½œè¦ç¯„ï¼šå¾Œç«¯ `docs/COLLABORATION.md`
> - åŒæ­¥æ©Ÿåˆ¶ï¼š
>   - è®€å–ï¼šå¾Œç«¯ `docs/sync-app.md`
>   - å›å ±ï¼šæœ¬å°ˆæ¡ˆ `docs/sync-backend.md`
```

##### 3. åœ¨å„è¨˜æ†¶åº«åŠ å…¥ã€Œè·¨ç«¯å°æ‡‰ã€æ¨™è¨»

åœ¨æ¯å€‹ `docs/memory-*.md` é–‹é ­åŠ å…¥ï¼š

```markdown
> **è·¨ç«¯å°æ‡‰**
> - å¾Œç«¯ï¼š`docs/memory-xxx.md`ï¼ˆå°æ‡‰çš„å¾Œç«¯è¨˜æ†¶åº«ï¼‰
> - å®˜ç¶²ï¼šï¼ˆå¦‚æœ‰å°æ‡‰ï¼‰
```

å°æ‡‰é—œä¿‚åƒè€ƒï¼š
| APP è¨˜æ†¶åº« | å°æ‡‰å¾Œç«¯è¨˜æ†¶åº« |
|------------|----------------|
| `memory-screens.md` | `memory-travel-gacha.md`ï¼ˆæ‰­è›‹ç•«é¢ï¼‰ã€`memory-merchant.md`ï¼ˆå•†å®¶ç•«é¢ï¼‰ |
| `memory-auth-flow.md` | `memory-auth.md` |
| `memory-api-client.md` | `docs/contracts/APP.md` |
| `memory-components.md` | ï¼ˆç„¡ç›´æ¥å°æ‡‰ï¼Œå‰ç«¯å°ˆå±¬ï¼‰ |
| `memory-state.md` | ï¼ˆç„¡ç›´æ¥å°æ‡‰ï¼Œå‰ç«¯å°ˆå±¬ï¼‰ |
| `memory-assets.md` | ï¼ˆç„¡ç›´æ¥å°æ‡‰ï¼Œå‰ç«¯å°ˆå±¬ï¼‰ |

---

#### é©—è­‰æ–¹å¼

1. `docs/sync-backend.md` æª”æ¡ˆå­˜åœ¨
2. CLAUDE.md åŒ…å«ã€Œä¸‰ç«¯å”ä½œã€æ®µè½
3. è¨˜æ†¶åº«æœ‰ã€Œè·¨ç«¯å°æ‡‰ã€æ¨™è¨»

---

#### å®Œæˆå¾Œ

1. Commit + Push
2. åœ¨ `docs/sync-backend.md` è¨˜éŒ„å®Œæˆç‹€æ…‹
3. å†æ¬¡ Commit + Push

---

### 2026-01-12ï¼šæ–°å¢åˆªé™¤å„ªæƒ åˆ¸ API + Gacha éŒ¯èª¤æ ¼å¼ä¿®æ­£

**è®Šæ›´é¡å‹**: API æ–°å¢ + API ä¿®æ”¹

---

#### 1. æ–°å¢ DELETE /api/coupons/:id

**Endpoint**:
```
DELETE /api/coupons/:id
```

**Headers**:
```
Authorization: Bearer <jwt_token>
```

**Response (æˆåŠŸ)**:
```json
{ "success": true, "message": "å„ªæƒ åˆ¸å·²åˆªé™¤" }
```

**Response (å¤±æ•—)**:
```json
{ "error": "ç„¡æ¬Šé™åˆªé™¤æ­¤å„ªæƒ åˆ¸", "code": "FORBIDDEN" }
{ "error": "å„ªæƒ åˆ¸ä¸å­˜åœ¨", "code": "NOT_FOUND" }
```

**é‚è¼¯èªªæ˜**:
- è»Ÿåˆªé™¤ï¼šè¨­ç‚º `archived: true` + `isActive: false`
- åªæœ‰å„ªæƒ åˆ¸æ“æœ‰è€…ï¼ˆå•†å®¶ï¼‰å¯ä»¥åˆªé™¤

---

#### 2. Gacha /gacha/pull/v3 éŒ¯èª¤æ ¼å¼ä¿®æ­£

**ä¿®æ”¹å‰**:
```json
{ "error": "Authentication required" }
{ "error": ["zod errors..."] }
{ "error": "Failed to perform gacha pull" }
```

**ä¿®æ”¹å¾Œ**:
```json
{ "error": "Authentication required", "code": "UNAUTHORIZED" }
{ "error": "åƒæ•¸æ ¼å¼éŒ¯èª¤", "code": "VALIDATION_ERROR", "details": [...] }
{ "error": "æŠ½å–å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦", "code": "SERVER_ERROR" }
```

**å‰ç«¯éœ€è¦åšçš„äº‹**:
- [ ] å¦‚æœ‰å•†å®¶åŠŸèƒ½ï¼Œæ–°å¢åˆªé™¤å„ªæƒ åˆ¸æŒ‰éˆ•å‘¼å« `DELETE /api/coupons/:id`
- [x] Gacha éŒ¯èª¤è™•ç†å·²å¯ä½¿ç”¨ `response.code` åˆ¤æ–·

---

### 2026-01-12ï¼šèªè­‰éŒ¯èª¤æ ¼å¼çµ±ä¸€

**è®Šæ›´é¡å‹**: API ä¿®æ”¹ï¼ˆéŒ¯èª¤å›æ‡‰æ ¼å¼ï¼‰

**å½±éŸ¿ç¯„åœ**: æ‰€æœ‰éœ€è¦èªè­‰çš„ API ç«¯é»

**ä¿®æ”¹å‰çš„éŒ¯èª¤æ ¼å¼**:
```typescript
// å¾Œç«¯è¿”å›ï¼ˆä¸ç¬¦åˆè¦ç¯„ï¼‰
{ message: "Unauthorized" }
{ message: "Invalid token" }
{ message: "User not found" }
{ message: "Forbidden: insufficient permissions" }
```

**ä¿®æ”¹å¾Œçš„éŒ¯èª¤æ ¼å¼**:
```typescript
// æ¨™æº–åŒ–éŒ¯èª¤å›æ‡‰
interface ApiError {
  error: string;  // äººé¡å¯è®€è¨Šæ¯
  code: string;   // æ©Ÿå™¨å¯è®€ä»£ç¢¼
}

// 401 éŒ¯èª¤
{ error: "Unauthorized", code: "UNAUTHORIZED" }
{ error: "Invalid token", code: "INVALID_TOKEN" }
{ error: "User not found", code: "USER_NOT_FOUND" }

// 403 éŒ¯èª¤
{ error: "Forbidden: insufficient permissions", code: "FORBIDDEN" }
```

**cURL æ¸¬è©¦**:
```bash
# æ¸¬è©¦ç„¡ Token è«‹æ±‚ï¼ˆæ‡‰è¿”å› 401ï¼‰
curl -X POST https://gacha-travel--s8869420.replit.app/api/gacha/itinerary/v3 \
  -H "Content-Type: application/json" \
  -d '{"regionId": 1, "days": 1}'

# é æœŸå›æ‡‰
{ "error": "Unauthorized", "code": "UNAUTHORIZED" }
```

**é‚è¼¯èªªæ˜**:
- çµ±ä¸€æ‰€æœ‰èªè­‰éŒ¯èª¤çš„å›æ‡‰æ ¼å¼ç‚º `{ error, code }`
- å‰ç«¯å¯é€é `response.error` æˆ– `response.code` åˆ¤æ–·éŒ¯èª¤é¡å‹
- ä¿®æ­£äº† 20% ç”¨æˆ¶ã€ŒæŸ¥ç„¡æ™¯é»ã€èª¤å ±å•é¡Œçš„å¾Œç«¯éƒ¨åˆ†

**å‰ç«¯éœ€è¦åšçš„äº‹**:
- [x] å·²æ–°å¢ `response.message` æª¢æŸ¥ï¼ˆç›¸å®¹èˆŠæ ¼å¼ï¼‰
- [x] å·²æ–°å¢ Token å‰ç½®æª¢æŸ¥
- [ ] å¯é¸ï¼šç§»é™¤ `response.message` æª¢æŸ¥ï¼ˆå¾Œç«¯å·²ä¸å†ä½¿ç”¨ï¼‰
- [ ] å»ºè­°ï¼šçµ±ä¸€ä½¿ç”¨ `response.error` æˆ– `response.code` åˆ¤æ–·éŒ¯èª¤

---

## æ­·å²è¨˜éŒ„

(ç„¡æ­·å²è¨˜éŒ„)
