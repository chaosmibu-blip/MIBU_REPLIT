# 遊戲經濟系統記憶庫 (Economy System)

## 模組範圍

用戶等級、經驗值、成就系統的完整設計，驅動用戶行為達成商業目標。

---

## 設計哲學

```
不是「讓用戶玩遊戲」
而是「用遊戲化驅動用戶做我們想要的事，並讓他們覺得有價值」
```

### 商業目標

| 我們希望用戶做的 | 對應機制 |
|------------------|----------|
| 每天上線 | 每日登入經驗 + 連續登入成就 |
| 每天把扭蛋抽滿 | 抽滿額度獎勵 |
| 探索更多地區 | 探索成就線 |
| 花錢募資 | 投資者成就線 + 專屬榮耀 |
| 互動分享 | 推廣者成就線 |
| 推薦用戶/商家 | 推廣者/業務成就線 + 實質獎勵 |
| 成為策劃師 | 策劃師成就線 + 服務收入 |
| 習慣使用 MIBU | 等級累積 = 沉沒成本 |

---

## 核心原則

| 項目 | 設計 |
|------|------|
| 功能 | **Lv.1 全開放**（不鎖功能） |
| 等級 | 純累積經驗，代表「資歷」 |
| 上限 | 99 等，**先開放到 30 等** |
| 里程碑 | 給頭框、稱號、造型 |
| 成就 | **五條線並行**，各有專屬榮耀 |

---

## 五種用戶角色

| 角色 | 對平台的價值 | 他們的閃光點 |
|------|-------------|-------------|
| **參與者** | 用戶基數、平台活躍度 | 收集圖鑑、探索城市、享受旅遊 |
| **投資者** | 資金、解鎖新地區 | 開拓世界、搶先體驗 |
| **推廣者** | 用戶增長 | 社群影響力、人脈網絡 |
| **業務** | 商家增長、營收 | 商業成就、現金回報 |
| **策劃師** | 服務旅客、創造價值 | 專業認可、服務收入 |

### 用戶傾向識別

系統追蹤用戶行為，識別傾向並推送對應任務：

```typescript
type UserTendency = {
  consumer: number;    // 參與者傾向（扭蛋、收藏）
  investor: number;    // 投資者傾向（募資）
  promoter: number;    // 推廣者傾向（分享、推薦用戶）
  business: number;    // 業務傾向（推薦商家）
  specialist: number;  // 策劃師傾向（服務、貢獻）
}
```

- 傾向可改變，不鎖定身份
- 展現多重傾向 → 多重任務 → 成長更快

---

## 等級系統 (Lv.1-30)

### 等級曲線

| 等級 | 累計經驗 | 單級所需 | 里程碑 |
|------|----------|----------|--------|
| 1 | 0 | - | 新手旅人 |
| 2 | 50 | 50 | |
| 3 | 120 | 70 | 初心者 |
| 4 | 210 | 90 | |
| 5 | 330 | 120 | 探索者 |
| 6 | 480 | 150 | |
| 7 | 670 | 190 | 貢獻者 |
| 8 | 900 | 230 | |
| 9 | 1,180 | 280 | |
| **10** | **1,500** | 320 | **資深旅人（策劃師邀請）** |
| 11 | 1,900 | 400 | |
| 12 | 2,400 | 500 | |
| 13 | 3,000 | 600 | 守護者 |
| 14 | 3,700 | 700 | |
| 15 | 4,500 | 800 | 冒險家 |
| 16 | 5,400 | 900 | |
| 17 | 6,400 | 1,000 | |
| 18 | 7,500 | 1,100 | 開拓者 |
| 19 | 8,700 | 1,200 | |
| **20** | **10,000** | 1,300 | **行者** |
| 21 | 11,500 | 1,500 | |
| 22 | 13,200 | 1,700 | |
| 23 | 15,100 | 1,900 | 導航者 |
| 24 | 17,200 | 2,100 | |
| 25 | 19,500 | 2,300 | 領路人 |
| 26 | 22,000 | 2,500 | |
| 27 | 24,700 | 2,700 | |
| 28 | 27,600 | 2,900 | 先驅者 |
| 29 | 30,700 | 3,100 | |
| **30** | **34,000** | 3,300 | **旅途大師（當前上限）** |

### 里程碑獎勵（不鎖功能，給榮耀）

| 等級 | 里程碑 | 獎勵 |
|------|--------|------|
| 3 | 初心者 | 初心者稱號 |
| 5 | 探索者 | 探索者頭框 |
| 7 | 貢獻者 | 貢獻者徽章 |
| 10 | 資深旅人 | **策劃師邀請** + 資深頭框 |
| 13 | 守護者 | 守護者徽章 |
| 15 | 冒險家 | 冒險家頭框 + 每日抽卡 +2 |
| 18 | 開拓者 | 開拓者稱號 |
| 20 | 行者 | 行者頭框 + 背包 +5 格 |
| 23 | 導航者 | 每日抽卡 +3 |
| 25 | 領路人 | 領路人頭框 + 背包 +5 格 |
| 28 | 先驅者 | 每日抽卡 +3 |
| 30 | 旅途大師 | 傳說頭框 |

### 權益累計

| 等級 | 每日抽卡上限 | 背包格數 |
|------|-------------|----------|
| 1 | 36 | 30 |
| 15 | 38 | 30 |
| 20 | 38 | 35 |
| 23 | 41 | 35 |
| 25 | 41 | 40 |
| 28 | 44 | 40 |
| 30 | 44 | 40 |

---

## 經驗值來源

### 每日任務

| 任務 | 經驗 | 每日上限 |
|------|------|----------|
| 每日登入 | 15 | 15 |
| 完成扭蛋（任意次數）| 10 | 10 |
| 抽滿當日額度 | 25 | 25 |
| 標記最愛/黑名單 | 3 | 15 |
| 參與排除投票 | 5 | 25 |
| 分享內容 | 10 | 30 |
| **每日上限合計** | | **~120** |

### 一次性經驗（首次/里程碑）

| 行為 | 經驗 |
|------|------|
| 完成首次扭蛋 | 50 |
| 探索第 2/5/10 個城市 | 80 / 150 / 300 |
| 完成城市圖鑑 50% / 100% | 200 / 500 |
| 首次參與募資 | 150 |
| 募資達標（每次）| 300 |
| 首次推薦用戶成功 | 100 |
| 首次推薦商家成功 | 200 |
| 首次回報通過 | 50 |
| 首次建議景點採納 | 100 |
| 連續登入 7 / 30 天 | 100 / 400 |

### 傾向行為經驗

| 行為 | 經驗 |
|------|------|
| 推薦用戶成功 | 250 |
| 被推薦人首次扭蛋 | 100 |
| 參與募資（每次）| 100 |
| 推薦商家成功 | 1,500 |
| 回報歇業通過 | 40 |
| 建議景點採納 | 120 |

### 成就解鎖經驗

| 成就稀有度 | 經驗獎勵 |
|------------|----------|
| ⭐ 普通 | 30 |
| ⭐⭐ 稀有 | 80 |
| ⭐⭐⭐ 史詩 | 200 |
| ⭐⭐⭐⭐ 傳說 | 500 |

### 策劃師服務經驗

| 服務類型 | 經驗 |
|----------|------|
| 完成基礎諮詢 | 300 |
| 完成行程規劃 | 800 |
| 獲得好評 | +150 |

---

## 成就系統

### 五條成就線

#### 參與者線（收藏家/探索家）

| 成就 | 條件 | 稀有度 | 經驗 | 獎勵 |
|------|------|--------|------|------|
| 初心收藏家 | 圖鑑 30 個 | ⭐ | 30 | 「收藏家」稱號 |
| 城市探索者 | 探索 5 城市 | ⭐ | 30 | 探索者頭框 |
| 美食獵人 | 美食類 30 個 | ⭐⭐ | 80 | 美食專屬框 |
| 城市征服者 | 完成 1 城市圖鑑 | ⭐⭐⭐ | 200 | 城市專屬框 |
| 七彩大師 | 7 分類各 20 個 | ⭐⭐⭐⭐ | 500 | 傳說收藏框 |
| 世界旅人 | 探索 15 城市 | ⭐⭐⭐⭐ | 500 | 「世界旅人」金色稱號 |

#### 投資者線（開拓者）

| 成就 | 條件 | 稀有度 | 經驗 | 獎勵 |
|------|------|--------|------|------|
| 開拓先鋒 | 首次募資 | ⭐⭐ | 80 | 「先鋒」徽章 |
| 地圖解鎖者 | 參與募資達標 | ⭐⭐ | 80 | 優先抽取權 24hr |
| 雙國開拓 | 2 國募資達標 | ⭐⭐⭐ | 200 | 開拓者頭框 |
| 世界開拓者 | 5 國募資達標 | ⭐⭐⭐⭐ | 500 | 「開拓者」金色稱號 |
| 創世贊助者 | 累計募資前 10% | ⭐⭐⭐⭐ | 500 | 傳說開拓框 + 名字上牆 |

#### 推廣者線（社群領袖）

| 成就 | 條件 | 稀有度 | 經驗 | 獎勵 |
|------|------|--------|------|------|
| 口碑傳播 | 推薦 3 人 | ⭐ | 30 | 「傳播者」稱號 |
| 人脈達人 | 推薦 10 人 | ⭐⭐ | 80 | 推廣者頭框 |
| 社群領袖 | 推薦 30 人 | ⭐⭐⭐ | 200 | 「領袖」金色稱號 |
| 影響力大師 | 推薦 100 人 | ⭐⭐⭐⭐ | 500 | 傳說社群框 |

#### 業務線（商業大使）

| 成就 | 條件 | 稀有度 | 經驗 | 獎勵 |
|------|------|--------|------|------|
| 商業夥伴 | 推薦 1 商家 | ⭐⭐ | 80 | 「夥伴」徽章 + 現金 |
| 業務達人 | 推薦 5 商家 | ⭐⭐⭐ | 200 | 業務頭框 |
| 商業大使 | 推薦 10 商家 | ⭐⭐⭐⭐ | 500 | 「大使」金色稱號 |
| 商業巨擘 | 推薦 30 商家 | ⭐⭐⭐⭐ | 500 | 傳說業務框 + 永久加成 |

#### 策劃師線（旅途大師）

| 成就 | 條件 | 稀有度 | 經驗 | 獎勵 |
|------|------|--------|------|------|
| 新手策劃師 | 完成首單 | ⭐⭐ | 80 | 「策劃師」徽章 |
| 專業策劃師 | 完成 10 單 | ⭐⭐⭐ | 200 | 策劃師頭框 |
| 五星策劃師 | 累計 50 好評 | ⭐⭐⭐⭐ | 500 | 「五星」金色稱號 |
| 旅途大師 | 完成 100 單 | ⭐⭐⭐⭐ | 500 | 傳說策劃框 |

---

## 策劃師機制

### Lv.10 策劃師邀請

```
用戶達到 Lv.10
       │
       ▼
┌─────────────────────────────────────────────────────┐
│  🎉 策劃師邀請（儀式感彈窗）                         │
│                                                     │
│  「恭喜你成為資深旅人！                              │
│   MIBU 邀請你成為旅程策劃師，                        │
│   為其他旅客提供專業的旅遊諮詢服務。                 │
│                                                     │
│   成為策劃師後，你可以：                             │
│   ✓ 接收系統配對的旅客諮詢                          │
│   ✓ 自訂你的服務時間                                │
│   ✓ 註冊金流帳戶，獲得服務報酬                      │
│                                                     │
│   [立即申請] [稍後再說]                              │
└─────────────────────────────────────────────────────┘
```

### 策劃師運作模式

- 系統自動分配：旅客選擇目的地 → 系統隨機配對該地區的線上策劃師
- 策劃師自主：可設定「開放時間」，離線時不會被配對
- 金流綁定：只有策劃師身份可註冊銀行帳戶

---

## 圖鑑與標記功能

| 功能 | 說明 |
|------|------|
| **圖鑑**（自動）| 扭蛋後自動收錄，記錄抽過的所有景點 |
| **我的最愛** ⭐ | 手動標記喜歡的景點 |
| **黑名單** 🚫 | 手動標記不喜歡的景點 |

### 黑名單排除機制

- 該景點一個月內累積 **50 人** 標記黑名單 → 降低抽取權重
- 該景點一個月內累積 **100 人** 標記黑名單 → 軟刪除

---

## 商家推薦機制

商家可以「推薦自己」：

```
商家想加入平台
       │
       ▼
註冊為一般用戶 → 自動 Lv.1
       │
       ▼
使用「推薦商家」功能 → 填寫自己的店家資訊
       │
       ▼
獲得推薦經驗（自推也算）
       │
       ▼
審核通過 → 商家身份啟用
       │
       ▼
前 1-2 個月免費試用
```

---

## 資料表設計

```typescript
// 等級定義
levelDefinitions {
  level: number,           // 1-30（先開放）, 31-99（預留）
  requiredExp: number,
  title: string,
  isUnlocked: boolean,     // 30 以上為 false
  perks: jsonb             // {"dailyPulls": 36, "inventorySlots": 30}
}

// 成就定義
achievements {
  id: serial,
  code: string unique,
  category: string,        // 'collector', 'investor', 'promoter', 'business', 'specialist'
  nameZh: string,
  description: string,
  rarity: number,          // 1-4 星
  triggerCondition: jsonb,
  expReward: number,
  otherRewards: jsonb,     // 頭框、稱號等
  isActive: boolean
}

// 用戶等級
userLevels {
  userId: string PK,
  currentExp: number,
  currentLevel: number,
  specialistInvitedAt: timestamp,
  specialistAppliedAt: timestamp,
  createdAt: timestamp,
  updatedAt: timestamp
}

// 經驗交易記錄
userExpTransactions {
  id: serial,
  userId: string,
  amount: number,
  eventType: string,
  referenceId: string,
  createdAt: timestamp
}

// 用戶成就
userAchievements {
  userId: string,
  achievementId: number,
  unlockedAt: timestamp,
  expClaimed: boolean
}

// 用戶傾向追蹤
userTendencies {
  userId: string PK,
  consumerScore: number,
  investorScore: number,
  promoterScore: number,
  businessScore: number,
  specialistScore: number,
  updatedAt: timestamp
}

// 景點黑名單統計
placeDislikeStats {
  placeId: number PK,
  monthlyDislikeCount: number,
  lastResetAt: timestamp,
  status: 'normal' | 'reduced' | 'excluded'
}
```

---

## 經濟平衡驗算

### 達到 Lv.30 (34,000 經驗) 所需時間

| 用戶類型 | 每日經驗 | 額外經驗 | 達 Lv.30 時間 |
|----------|----------|----------|---------------|
| 輕度（只登入抽卡）| ~50 | 成就 ~800 | 22 個月 |
| 中度（抽滿+投票）| ~100 | 成就 ~1,500 | 11 個月 |
| 活躍（+推薦用戶 5 人）| ~100 | +1,750 | 6 個月 |
| 重度（+募資+推薦商家）| ~120 | +5,000+ | **2-3 個月** |
| 策劃師（每週 5 單）| ~120 | +6,000/月 | **1.5-2 個月** |

### 成就經驗貢獻

成就經驗約佔總經驗的 **9%**（~3,100 / 34,000）

---

## 未來擴充（Lv.31-99）

- 預留給專業遊戲經濟設計師
- 當有用戶達到 Lv.30 時再規劃
- 主要經驗來源預計為策劃師服務

---

## 與其他模組的關聯

- **扭蛋模組**: 扭蛋完成 → 觸發經驗獎勵
- **募資模組**: 參與/達標 → 觸發經驗 + 成就
- **推薦模組**: 推薦成功 → 觸發經驗 + 成就
- **策劃師模組**: 完成服務 → 觸發經驗 + 成就
- **商家模組**: 推薦商家 → 觸發經驗 + 成就 + 現金

---

## 待開發功能

- [ ] 等級系統 API
- [ ] 成就系統 API
- [ ] 用戶傾向追蹤
- [ ] 策劃師邀請彈窗
- [ ] 黑名單排除機制
- [ ] 經驗值事件驅動架構
